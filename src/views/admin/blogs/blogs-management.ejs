<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Qu·∫£n l√Ω Blog</title>
    <link rel="stylesheet" href="/admin/css/blogs/blogs-management.css" />
    <link rel="stylesheet" href="/admin/css/style.css" />
    <script src="https://cdn.ckeditor.com/ckeditor5/41.1.0/classic/ckeditor.js"></script>
  </head>
  <body>
    <div class="container">
      <%- include('../layout/sidebar.ejs'); -%>
      <!-- <Header -->
      <div class="header1">
        <div class="breadcrumb1">
          Qu·∫£n l√Ω Blog<br />
          <small style="color: black; font-size: 14px"
            >T·∫°o, ch·ªânh s·ª≠a v√† qu·∫£n l√Ω c√°c b√†i vi·∫øt blog</small
          >
        </div>
      </div>

      <!-- Main Content -->
      <div class="container-wrapper">
        <main class="main-content">
          <!-- Updated filters section to match schema -->
          <div class="filters-section">
            <div class="filters-left">
              <div class="search-wrapper">
                <svg
                  class="search-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="11" cy="11" r="8"></circle>
                  <path d="m21 21-4.35-4.35"></path>
                </svg>
                <input
                  type="text"
                  id="searchInput"
                  class="search-input"
                  placeholder="T√¨m ki·∫øm blog..."
                />
              </div>

              <div class="filter-group">
                <select id="typeFilter" class="filter-select">
                  <option value="">T·∫•t c·∫£ lo·∫°i</option>
                  <option value="NEWS">Tin t·ª©c</option>
                  <option value="PROMOTION">Khuy·∫øn m√£i</option>
                  <option value="PRODUCT">S·∫£n ph·∫©m</option>
                  <option value="EVENT">S·ª± ki·ªán</option>
                  <option value="GUIDE">H∆∞·ªõng d·∫´n</option>
                </select>

                <select id="statusFilter" class="filter-select">
                  <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                  <option value="DRAFT">B·∫£n nh√°p</option>
                  <option value="PUBLISHED">ƒê√£ xu·∫•t b·∫£n</option>
                  <option value="ARCHIVED">ƒê√£ l∆∞u tr·ªØ</option>
                </select>
              </div>
            </div>

            <button
              class="btn-advanced-filter"
              onclick="openCreateBlogDrawer()"
            >
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              T·∫°o blog m·ªõi
            </button>
          </div>

          <!-- Blogs Grid -->
          <div class="blogs-grid" id="blogsGrid">
            <!-- Blog cards will be rendered here -->
          </div>

          <!-- Empty State -->
          <div class="empty-state" id="emptyState" style="display: none">
            <div class="empty-icon">üìù</div>
            <h3>Kh√¥ng c√≥ blog n√†o</h3>
            <p>B·∫Øt ƒë·∫ßu b·∫±ng c√°ch t·∫°o b√†i vi·∫øt blog ƒë·∫ßu ti√™n c·ªßa b·∫°n</p>
          </div>
        </main>
      </div>

      <!-- Create/Edit Blog Drawer - now integrated with form -->
      <div class="drawer-overlay" id="blogDrawerOverlay"></div>
      <div class="blog-drawer hidden" id="blogDrawer">
        <div class="drawer-header">
          <h2 id="drawerTitle">T·∫°o blog m·ªõi</h2>
          <button class="close-btn" id="closeDrawerBtn">&times;</button>
        </div>
        <div class="drawer-content">
          <form id="blogForm" class="blog-form">
            <div class="form-section">
              <h3 class="form-section-title">Th√¥ng tin c∆° b·∫£n</h3>
              <div class="form-group">
                <label for="title">Ti√™u ƒë·ªÅ *</label>
                <input
                  type="text"
                  id="title"
                  name="title"
                  required
                  placeholder="Nh·∫≠p ti√™u ƒë·ªÅ blog"
                />
              </div>
              <div class="form-group">
                <label for="slug">Slug *</label>
                <input
                  type="text"
                  id="slug"
                  name="slug"
                  required
                  placeholder="url-friendly-slug"
                />
              </div>
              <div class="form-group">
                <label for="description">M√¥ t·∫£ ng·∫Øn *</label>
                <textarea
                  id="description"
                  name="description"
                  required
                  rows="2"
                  placeholder="M√¥ t·∫£ ng·∫Øn g·ªçn v·ªÅ b√†i vi·∫øt (t·ªëi ƒëa 500 k√Ω t·ª±)"
                ></textarea>
              </div>
            </div>

            <div class="form-section">
              <h3 class="form-section-title">Ph√¢n lo·∫°i</h3>
              <div class="form-row">
                <div class="form-group">
                  <label for="type">Lo·∫°i b√†i vi·∫øt *</label>
                  <select id="type" name="type" required>
                    <option value="">Ch·ªçn lo·∫°i</option>
                    <option value="NEWS">Tin t·ª©c</option>
                    <option value="PROMOTION">Khuy·∫øn m√£i</option>
                    <option value="PRODUCT">S·∫£n ph·∫©m</option>
                    <option value="EVENT">S·ª± ki·ªán</option>
                    <option value="GUIDE">H∆∞·ªõng d·∫´n</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="status">Tr·∫°ng th√°i *</label>
                  <select id="status" name="status" required>
                    <option value="DRAFT">B·∫£n nh√°p</option>
                    <option value="PUBLISHED">ƒê√£ xu·∫•t b·∫£n</option>
                    <option value="ARCHIVED">ƒê√£ l∆∞u tr·ªØ</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="form-section">
              <h3 class="form-section-title">N·ªôi dung</h3>
              <div class="form-group">
                <label for="thumbnail">·∫¢nh ƒë·∫°i di·ªán</label>
                <div class="image-upload">
                  <input
                    type="file"
                    id="thumbnail"
                    name="thumbnail"
                    accept="image/*"
                  />
                  <div class="upload-preview" id="thumbnailPreview"></div>
                </div>
              </div>
              <div class="form-group">
                <label for="content">N·ªôi dung *</label>
                <textarea id="content" name="content" required></textarea>
              </div>
            </div>

            <div class="form-section">
              <h3 class="form-section-title">SEO</h3>
              <div class="form-group">
                <label for="metaTitle">Meta Title</label>
                <input
                  type="text"
                  id="metaTitle"
                  name="metaTitle"
                  placeholder="Ti√™u ƒë·ªÅ SEO"
                />
              </div>
              <div class="form-group">
                <label for="metaDescription">Meta Description</label>
                <textarea
                  id="metaDescription"
                  name="metaDescription"
                  placeholder="M√¥ t·∫£ SEO"
                  rows="2"
                ></textarea>
              </div>
            </div>
          </form>
        </div>
        <div class="drawer-footer">
          <button
            type="button"
            class="btn btn-outline"
            onclick="closeBlogDrawer()"
          >
            H·ªßy
          </button>
          <button type="button" class="btn btn-primary" onclick="submitBlog()">
            L∆∞u blog
          </button>
        </div>
      </div>

      <!-- Blog Detail Modal -->
      <div class="modal-overlay" id="blogModalOverlay">
        <div class="blog-modal" id="blogModal">
          <div class="modal-header">
            <h2 id="modalTitle">Chi ti·∫øt blog</h2>
            <button class="close-btn" id="closeModalBtn">&times;</button>
          </div>
          <div class="modal-content" id="modalContent">
            <!-- Content will be rendered here -->
          </div>
          <div class="modal-footer">
            <button class="btn btn-outline" onclick="closeBlogModal()">
              ƒê√≥ng
            </button>
            <button class="btn btn-primary" onclick="editBlog()">
              Ch·ªânh s·ª≠a
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="/admin/js/blogs/blogs-management.js"></script>
  </body>
</html>
