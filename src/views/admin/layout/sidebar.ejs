<!-- Sidebar -->
<nav class="sidebar">
    <a
        class="navbar-brand d-flex align-items-center"
        onclick="location.href='/admin/home'"
        style="margin: auto; padding-bottom: 20px"
    >
        <img
            class="logo_nav"
            src="/images/logo1.png"
            alt=""
            style="width: 110px; height: auto; object-fit: cover"
        />
    </a>
    <hr style=" border: none;
    border-top: 1px solid rgba(0,0,0,0.2);
    height: 0;" />
    <div class="menu" style="padding-top: 20px">
        <a href="/admin" class="menu-item active">
            <i class="fa-solid fa-house" style="color: #ffffff"></i>
            <span>Trang Chủ</span>
        </a>
        <a href="/admin/products" class="menu-item">
            <i class="fa-solid fa-mug-hot" style="color: #ffffff"></i>
            <span>Sản Phẩm</span>
        </a>
        <a href="/admin/categories" class="menu-item">
            <i class="fa-solid fa-list" style="color: #ffffff"></i>
            <span>Danh mục</span>
        </a>
        <a href="/admin/customer" class="menu-item">
            <i class="fa-solid fa-user" style="color: #ffffff"></i>
            <span>Khách hàng</span>
        </a>
        <a href="/admin/staff" class="menu-item">
            <i class="fa-solid fa-user-tie" style="color: #ffffff"></i>
            <span>Nhân viên</span>
        </a>
        <a href="/admin/orders" class="menu-item">
            <i class="fa-solid fa-newspaper" style="color: #ffffff"></i>
            <span>Đơn hàng</span>
        </a>
          <a href="/admin/promotions" class="menu-item">
            <i class="fa-regular fa-percent" style="color: #ffffff;"></i>
            <span>Khuyến mãi</span>
        </a>
        <a href="/admin/statistics" class="menu-item">
            <i class="fa-solid fa-chart-line" style="color: #ffffff"></i>
            <span>Thống kê</span>
        </a>
        <a href="#" class="menu-item">
            <i class="fa-solid fa-gear" style="color: #ffffff"></i>
            <span>Cài đặt</span>
        </a>
    </div>
<div class="sidebar-footer">
    <% if (userCurrent) { %>
        <div class="user-info">
            <img src="<%= userCurrent.avatar ? userCurrent.avatar : '/images/users/avatar-face.jpg' %>" class="user-avatar-sidebar" />
            <div class="user-details">

                <div class="name"><%= userCurrent.username %></div>
                <div class="role">
                    <%= userCurrent.role_id === 1 ? "Quản trị viên" : "Nhân viên" %>
                </div>
            </div>
        </div>

       <div  class="logout-btn" onclick="handleLogout()" >
            <i class="fa-solid fa-right-from-bracket"></i> Logout
        </div>
    <% } %>
</div>
</nav>

<script>
// ✅ Đưa hàm ra ngoài để onclick có thể gọi được
async function handleLogout() {
  if (confirm("Bạn có chắc chắn muốn đăng xuất?")) {
    try {
      const res = await fetch("/auth/logout", { method: "GET" });
      if (res.ok) {
        window.location.href = "/auth/login";
      } else {
        console.error("Logout failed:", res.status);
      }
    } catch (error) {
      console.error("Logout error:", error);
    }
  }
}

document.addEventListener("DOMContentLoaded", () => {
    const currentPath = window.location.pathname;
    const menuLinks = document.querySelectorAll(".menu-item");

    menuLinks.forEach(link => {
        const linkPath = link.getAttribute("href");
        
        if (currentPath.startsWith(linkPath)) {
            menuLinks.forEach(l => l.classList.remove("active"));
            link.classList.add("active");
        }
    });
});
</script>

