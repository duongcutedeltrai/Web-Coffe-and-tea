<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MIRA - Whiskas Dry Adult Dewasa 7+</title>
    <link rel="stylesheet" href="/admin/css/style.css" />
    <link rel="stylesheet" href="/admin/css/users/user.css" />
    <link rel="stylesheet" href="/admin/css/users/addUser.css" />
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
        integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <div class="container">
        <%- include('../layout/sidebar.ejs'); -%>
            <%- include('../layout/header.ejs'); -%>

                <!-- Main Content -->
                <main class="main-content">
                    <%- include('create_user.ejs', { roles: roles }); -%>

                        <!-- Stats Section -->
                        <h1 class="title" style="margin-bottom: 20px;">Quản lý Nhân viên</h1>

                        <!-- Filters Section -->
                        <section class="filters-section">
                            <div class="filters-section_header">
                                <div class="filters-header">
                                    <h3>Bộ lọc và tìm kiếm</h3>
                                    <p>Tìm kiếm và lọc khách hàng theo các tiêu chí</p>
                                </div>
                            </div>

                            <div class="filters-row">
                                <div class="filter-group">
                                    <label>Tìm kiếm</label>
                                    <div class="search-wrapper">
                                        <i class="fas fa-search"></i>
                                        <input type="text" class="search-input"
                                            placeholder="Tìm kiếm theo tên, email hoặc số điện thoại...">


                                        <div class="search-member">
                                            <button class="btn btn-primary">Tìm kiếm</button>
                                        </div>
                                    </div>

                                </div>

                                <div class="filter-group">
                                    <label>Vai trò</label>
                                    <select class="filter-select">
                                        <option>Tất cả vai trò</option>
                                        <option>Quản lý</option>
                                        <option>Pha Chế</option>
                                        <option>Tiếp thực</option>
                                        <option>Phục vụ</option>
                                        <option>Bếp chính</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Trạng thái</label>
                                    <select class="filter-select">
                                        <option>Tất cả trạng thái</option>
                                        <option>Hoạt động</option>
                                        <option>Bị khóa</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Ngày tham gia</label>
                                    <select class="filter-select">
                                        <option>Tất cả thời gian</option>
                                        <option>7 ngày qua</option>
                                        <option>30 ngày qua</option>
                                        <option>3 tháng qua</option>
                                    </select>
                                </div>

                                <div class="filter-member">
                                    <button class="btn btn-primary">Lọc</button>
                                </div>
                            </div>
                        </section>

                        <!-- staff Table -->
                        <section class="table-section">
                            <div class="table-header">
                                <div class="tab-buttons">
                                    <button class="tab-btn active" data-tab="all">Tất cả nhân viên</button>
                                    <button class="tab-btn" data-tab="schedule">Lịch làm việc</button>
                                </div>
                                <div style="display: flex; gap: 10px">
                                    <button class="btn btn-secondary">
                                        <i class="fas fa-download"></i>
                                        Xuất Excel
                                    </button>

                                    <div class="filter-group">
                                        <button class="btn btn-primary" onclick="openAddModal()">
                                            <i class="fas fa-plus"></i>
                                            Thêm tài khoản
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-content active" id="allTab">
                                <table class="customer-table">
                                    <thead>
                                        <tr>
                                            <th>Tên</th>
                                            <th>email</th>
                                            <th>Vai trò</th>
                                            <th>Giới tính</th>
                                            <th>Thao tác</th>
                                        </tr>
                                    </thead>

                                    <tbody id="staffTableBody">
                                        <% staffs.forEach(function (staff) { %>
                                            <tr onclick="window.location= '/admin/staff/detail_staff/<%= staff.user_id %>'"
                                                style="cursor: pointer">
                                                <td>
                                                    <%= staff.username %>
                                                </td>
                                                <td>
                                                    <%= staff.email %>
                                                </td>
                                                <td>
                                                    <% if(staff.roles.name==="ADMIN" ) { %>
                                                        <span class="role-badge admin">Admin</span>
                                                        <% } else { %>
                                                            <span class="role-badge staff">
                                                                <%= staff.staff_detail?.position %>
                                                            </span>
                                                            <% } %>
                                                </td>
                                                <td>
                                                    <%= staff.gender %>
                                                </td>
                                                <td>
                                                    <div style="
                                                display: flex;
                                                gap: 20px;
                                                position: relative;
                                                left: 100px;
                                            ">
                                                        <% if (staff.status==="ACTIVE" ) { %>
                                                            <form action="/admin/staff/lock-staff/<%= staff.user_id %>"
                                                                method="post">
                                                                <button type="submit" class="btn btn-warning btn-lock">
                                                                    Khóa
                                                                </button>
                                                            </form>
                                                            <% } else { %>
                                                                <form
                                                                    action="/admin/staff/unlock-staff/<%= staff.user_id %>"
                                                                    method="post">
                                                                    <button type="submit"
                                                                        class="btn btn-success btn-unlock">
                                                                        Mở khóa
                                                                    </button>
                                                                </form>
                                                                <% } %>
                                                                    <form
                                                                        action="/admin/delete-staff/<%= staff.user_id %>"
                                                                        method="post">
                                                                        <button type="submit" class="btn btn-danger">
                                                                            Xóa
                                                                        </button>
                                                                    </form>
                                                    </div>
                                                </td>
                                            </tr>
                                            <% }) %>
                                    </tbody>
                                </table>
                            </div>

                            <div class="tab-content" id="scheduleTab"></div>

                            <!-- Pagination -->
                            <ul class="pagination" id="staffPagination">
                                <!-- JS sẽ render -->
                                <li>
                                    <a class="<%= pageStaff === 1 || totalPageStaffs === 1 ? 'disabled' : '' %>"
                                        href="/admin/staff?pageStaff=<%= pageStaff - 1 %>">&laquo; Prev</a>
                                </li>

                                <% for(let i=1; i <=totalPageStaffs; i++) { %>
                                    <li>
                                        <a class="<%= pageStaff === i ? 'active' : '' %>"
                                            href="/admin/staff?pageStaff=<%= i %>">
                                            <%= i %>
                                        </a>
                                    </li>
                                    <% } %>

                                        <li>
                                            <a class="<%= pageStaff === totalPageStaffs || totalPageStaffs === 1 ? 'disabled' : '' %>"
                                                href="/admin/staff?pageStaff=<%= pageStaff + 1 %>">Next
                                                &raquo;</a>
                                        </li>
                            </ul>
                        </section>
                </main>
    </div>
    <script src="/admin/js/users/users.js"></script>
</body>

</html>